<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>RR Audiobooks Prototype — v9</title>
  <link href="https://fonts.googleapis.com/css2?family=Crimson+Pro:ital,wght@0,400;0,600;0,700;1,400&family=DM+Sans:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { background: #1a1a2e; min-height: 100vh; display: flex; align-items: flex-start; justify-content: center; padding: 20px 0 40px; }
    @keyframes waveBar { 0% { transform: scaleY(1); } 35% { transform: scaleY(var(--peak, 1)); } 65% { transform: scaleY(0.5); } 100% { transform: scaleY(1); } }
    @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.4; } }
  </style>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useMemo, useEffect, useRef } = React;

    const colors = {
      headerBg: "#3b6fa0",
      cardBg: "#4a7fb3",
      pageBg: "#f5f5f5",
      contentBg: "#ffffff",
      accent: "#3b6fa0",
      text: "#2a2a2a",
      textMuted: "#7a7a7a",
      red: "#d32f2f",
      searchBg: "rgba(255,255,255,0.15)",
      searchBgLight: "#f0f0f0",
    };

    // ═══ WATCH TAB — DESIGN TOKENS ═══
    const wC = {
      bg: "#FFFFFF", surface: "#F5F5F7", card: "#FFFFFF",
      border: "rgba(0,0,0,0.08)",
      gold: "#B8922E", goldSoft: "rgba(184,146,46,0.08)", goldText: "#8A6D1B",
      prayerAccent: "#2E7D4C",
      live: "#D43333", liveSoft: "rgba(212,51,51,0.05)", liveBg: "#FEF2F2",
      text1: "#1A1A1A", text2: "#6B6B6B", text3: "#9A9A9A", text4: "#C8C8C8",
      newBadge: "#1A6B3A", newBadgeSoft: "rgba(26,107,58,0.08)",
      shadow: "0 1px 3px rgba(0,0,0,0.06), 0 1px 2px rgba(0,0,0,0.04)",
      shadowMd: "0 4px 12px rgba(0,0,0,0.06), 0 1px 3px rgba(0,0,0,0.04)",
    };

    const audiobooks = {
      spiritual: [
        { id: "s1", title: "Mary at the Crossroads of History", author: "Fr. Francis J. Hoffman", narrator: "Fr. Francis J. Hoffman", duration: "3h 38m", color: "#1a3a5c", image: "covers/mary-at-the-crossroads.png",
          summary: "Adam and Eve, our first parents, had free will, and their choices set in motion the entire drama of salvation history. This audiobook traces the thread of Mary's role from Genesis through Revelation, showing how the Blessed Mother stands at every crossroads of human history as a guide, intercessor, and model of faith.",
          credits: { producer: "Michael Torres", director: "Sarah Chen", editor: "James Whitfield", sound: "David Park", music: "Anna Kowalski", project: "The Merry Beggars Audio" } },
        { id: "s2", title: "Confessions", author: "St. Augustine of Hippo", narrator: "Demetrios Troy", duration: "12h 45m", color: "#5c3a1a", image: "covers/confessions.jpg",
          summary: "One of the most influential works in Western literature, the Confessions traces Augustine's spiritual journey from his sinful youth through his conversion to Christianity. Written as a prayer to God, this autobiography reveals the inner struggles of a brilliant mind wrestling with truth, desire, and grace.",
          credits: { producer: "Michael Torres", director: "Sarah Chen", editor: "Demetrios Troy", sound: "David Park", music: "Anna Kowalski", project: "The Merry Beggars Audio" } },
        { id: "s3", title: "The Interior Castle", author: "St. Teresa of Ávila", narrator: "Maria Santos", duration: "6h 12m", color: "#3a1a5c", image: "covers/interior-castle.jpg",
          summary: "St. Teresa of Ávila's masterpiece of mystical theology describes the soul as a castle with seven dwelling places, each representing a stage of spiritual growth. Written for her Carmelite sisters, this work remains one of the most practical and profound guides to the interior life ever composed.",
          credits: { producer: "Michael Torres", director: "James Whitfield", editor: "Maria Santos", sound: "David Park", music: "Anna Kowalski", project: "The Merry Beggars Audio" } },
        { id: "s4", title: "Introduction to the Devout Life", author: "St. Francis de Sales", narrator: "James Whitfield", duration: "8h 30m", color: "#1a5c3a", image: "covers/introduction-devout-life.jpg",
          summary: "Written originally as a series of letters of spiritual direction, St. Francis de Sales composed this timeless guide to show that holiness is possible for everyone, not just monks and nuns. Practical, warm, and deeply human, it covers prayer, the sacraments, temptation, and the virtues needed for daily Christian living.",
          credits: { producer: "Sarah Chen", director: "Michael Torres", editor: "James Whitfield", sound: "David Park", music: "Anna Kowalski", project: "The Merry Beggars Audio" } },
        { id: "s5", title: "Story of a Soul", author: "St. Thérèse of Lisieux", narrator: "Catherine Hart", duration: "5h 55m", color: "#5c1a3a", image: "covers/story-of-a-soul.jpg",
          summary: "The autobiography of St. Thérèse of Lisieux, written under obedience to her religious superiors, reveals her 'Little Way' of spiritual childhood — a path to holiness through small acts of love and trust in God's mercy. This intimate account became one of the most widely read spiritual books of the twentieth century.",
          credits: { producer: "Michael Torres", director: "Sarah Chen", editor: "Catherine Hart", sound: "David Park", music: "Anna Kowalski", project: "The Merry Beggars Audio" } },
      ],
      fiction: [
        { id: "f1", title: "Brideshead Revisited", author: "Evelyn Waugh", narrator: "James Whitfield", duration: "11h 20m", color: "#2a5a2a", image: "covers/brideshead-revisited.jpg",
          summary: "Charles Ryder's enchantment with the aristocratic Flyte family and their crumbling estate, Brideshead, weaves a story of memory, beauty, faith, and the relentless pursuit of grace. Waugh's masterpiece explores how God works through even the most broken and resistant souls.",
          credits: { producer: "Michael Torres", director: "Sarah Chen", editor: "James Whitfield", sound: "David Park", music: "Anna Kowalski", project: "The Merry Beggars Audio" } },
        { id: "f2", title: "The Power and the Glory", author: "Graham Greene", narrator: "Demetrios Troy", duration: "7h 15m", color: "#4a2a1a", image: "covers/power-and-the-glory.jpg",
          summary: "Set during the anti-clerical purges in 1930s Mexico, Greene's novel follows an unnamed 'whiskey priest' — the last remaining clergyman in the state — as he flees persecution while struggling with his own sinfulness. A devastating portrait of grace operating through human weakness.",
          credits: { producer: "Sarah Chen", director: "Michael Torres", editor: "Demetrios Troy", sound: "David Park", music: "Anna Kowalski", project: "The Merry Beggars Audio" } },
        { id: "f3", title: "Kristin Lavransdatter", author: "Sigrid Undset", narrator: "Catherine Hart", duration: "18h 40m", color: "#1a3a5c", image: "covers/kristin-lavransdatter.jpg",
          summary: "Nobel Prize-winning epic set in medieval Norway, following Kristin from her sheltered childhood through a passionate and often turbulent marriage, motherhood, and ultimately a life transformed by faith. Undset's trilogy is one of the great Catholic novels of the twentieth century.",
          credits: { producer: "Michael Torres", director: "James Whitfield", editor: "Catherine Hart", sound: "David Park", music: "Anna Kowalski", project: "The Merry Beggars Audio" } },
        { id: "f4", title: "The Lord of the Rings", author: "J.R.R. Tolkien", narrator: "Martin Shaw", duration: "22h 30m", color: "#3a2a1a", image: "covers/lord-of-the-rings.png",
          summary: "Tolkien's epic tale of hobbits, elves, and the struggle against darkness is fundamentally a Catholic work — a story of providence, sacrifice, mercy, and the power of the small and humble to change the course of history. The greatest fantasy novel ever written, brought to life in audio.",
          credits: { producer: "Michael Torres", director: "Sarah Chen", editor: "Martin Shaw", sound: "David Park", music: "Anna Kowalski", project: "The Merry Beggars Audio" } },
      ],
    };

    const allBooks = [...audiobooks.spiritual, ...audiobooks.fiction];

    const continueListeningData = [
      { book: audiobooks.spiritual[1], progress: 65, timeLeft: "4h 28m" },   // Confessions
      { book: audiobooks.fiction[0], progress: 30, timeLeft: "7h 56m" },     // Brideshead Revisited
      { book: audiobooks.spiritual[4], progress: 85, timeLeft: "53m" },      // Story of a Soul
      { book: audiobooks.fiction[2], progress: 12, timeLeft: "16h 25m" },    // Kristin Lavransdatter
    ];

    // ═══ WATCH TAB — DATA ═══
    const WATCH_SERIES = [
      { id: "daily-mass", title: "Daily Mass", subtitle: "Live from the Chapel", episodes: 180, category: "Prayer", gradient: "linear-gradient(170deg, #7A6B52 0%, #5C4F3A 60%, #3D3528 100%)", description: "Daily Mass celebrated live from the Relevant Radio Chapel. Join us every day at 12:00 PM CT.", host: "Fr. Rocky", isLive: true, liveTime: "12:00 PM CT" },
      { id: "family-rosary", title: "Family Rosary", subtitle: "Pray together every evening", episodes: 230, category: "Prayer", gradient: "linear-gradient(170deg, #5B6B4F 0%, #3F5233 60%, #2A3B22 100%)", description: "Join Fr. Rocky and the Relevant Radio family for the nightly Rosary. Live every evening at 7:00 PM CT.", host: "Fr. Rocky", isLive: true, liveTime: "7:00 PM CT" },
      { id: "divine-mercy", title: "Divine Mercy Chaplet", subtitle: "The Hour of Mercy", episodes: 160, category: "Prayer", gradient: "linear-gradient(170deg, #4F6275 0%, #3A4F63 60%, #253A4D 100%)", description: "Pray the Divine Mercy Chaplet live every day at 3:00 PM CT — the Hour of Mercy.", host: "Drew Mariani", isLive: true, liveTime: "3:00 PM CT" },
      { id: "fulton-sheen", title: "Fulton Sheen", subtitle: "Life Is Worth Living", episodes: 60, category: "Catechesis", gradient: "linear-gradient(140deg, #E8E4F0, #D0C8E0)", description: "The legendary Bishop Fulton J. Sheen in his iconic television series.", host: "Bp. Fulton Sheen" },
      { id: "lenten-mass", title: "Lenten Lessons on the Mass", subtitle: "Fr. Rocky's teaching series", episodes: 40, category: "Catechesis", gradient: "linear-gradient(140deg, #EDE6F5, #D8CEE8)", description: "A structured 40-lesson catechetical journey through the Mass with Fr. Rocky.", host: "Fr. Rocky" },
      { id: "lenten-sacraments", title: "Lenten Lessons on the Sacraments", subtitle: "Fr. Rocky's teaching series", episodes: 40, category: "Catechesis", gradient: "linear-gradient(140deg, #E6EDF5, #CED8E8)", description: "A 40-lesson deep dive into the seven sacraments with Fr. Rocky.", host: "Fr. Rocky" },
      { id: "eucharistic-encounters", title: "Eucharistic Encounters", subtitle: "Fr. Rocky on the Real Presence", episodes: 12, category: "Catechesis", gradient: "linear-gradient(140deg, #F0E8DC, #E0D4C0)", description: "Fr. Rocky explores the mystery and beauty of the Real Presence.", host: "Fr. Rocky" },
      { id: "5min-homilies", title: "5-Minute Homilies", subtitle: "Weekly Sunday reflections", episodes: 50, category: "Catechesis", gradient: "linear-gradient(140deg, #E4F0E8, #D0E8DC)", description: "Short, powerful homilies for every Sunday of the year.", host: "Various Priests" },
      { id: "into-the-breach", title: "Into the Breach", subtitle: "A call to Catholic men", episodes: 8, category: "Catechesis", gradient: "linear-gradient(140deg, #E8E4E0, #D8D0C8)", description: "Knights of Columbus film series challenging Catholic men to step into the breach.", host: "Knights of Columbus" },
      { id: "patrick-madrid", title: "Patrick Madrid", subtitle: "Apologetics & Catholic Living", episodes: 10, category: "Shows", gradient: "linear-gradient(140deg, #F0E8E4, #E0D4CC)", description: "Curated apologetics talks from The Patrick Madrid Show.", host: "Patrick Madrid" },
      { id: "vatican-today", title: "The Vatican Today", subtitle: "Weekly news from Rome", episodes: 4, category: "Shows", gradient: "linear-gradient(140deg, #D8E4F0, #C0D0E8)", description: "Weekly 27-minute news analysis from the heart of the Church.", host: "Relevant Radio" },
      { id: "drew-mariani", title: "Drew Mariani Show", subtitle: "Faith, culture & current events", episodes: 35, category: "Shows", gradient: "linear-gradient(140deg, #E4E8F0, #D0D8E8)", description: "Clips from The Drew Mariani Show.", host: "Drew Mariani" },
      { id: "timmerie", title: "Timmerie", subtitle: "Catholic femininity & culture", episodes: 22, category: "Shows", gradient: "linear-gradient(140deg, #F0E4E8, #E8D0D8)", description: "Clips from Trending with Timmerie.", host: "Timmerie Millington" },
      { id: "seek-2026", title: "SEEK 2026", subtitle: "Full conference talks", episodes: 24, category: "Conferences", gradient: "linear-gradient(140deg, #E8E0F0, #D8D0E8)", description: "Every keynote and breakout from SEEK 2026.", host: "FOCUS" },
      { id: "seek-2025", title: "SEEK 2025", subtitle: "Keynote sessions", episodes: 9, category: "Conferences", gradient: "linear-gradient(140deg, #E0D8F0, #D0C8E0)", description: "Keynote recordings from SEEK 2025.", host: "FOCUS" },
      { id: "lenten-2026", title: "Lenten Series 2026", subtitle: "Seasonal journey through Lent", episodes: 12, category: "Seasonal", gradient: "linear-gradient(140deg, #F0EAE0, #E0D8C8)", description: "A guided Lenten journey with daily reflections.", host: "Various" },
      { id: "doc-collection", title: "Documentaries", subtitle: "Feature-length Catholic films", episodes: 6, category: "Documentaries", gradient: "linear-gradient(140deg, #E0DCD4, #C8C0B4)", description: "Six documentary films exploring the Catholic faith.", host: "Various" },
      { id: "the-quest", title: "The Quest", subtitle: "University of Dallas series", episodes: 11, category: "Documentaries", gradient: "linear-gradient(140deg, #E8E0D4, #D4CCB8)", description: "An 11-episode academic series from the University of Dallas.", host: "University of Dallas" },
      { id: "virtuous-leadership", title: "Virtuous Leadership", subtitle: "Lead with virtue", episodes: 9, category: "Catechesis", gradient: "linear-gradient(140deg, #E4E0EC, #D0CCE0)", description: "A 9-episode leadership teaching series grounded in the virtues.", host: "Various" },
    ];

    const WATCH_PRAYERS = [
      { id: "mass", seriesId: "daily-mass", label: "Daily Mass", shortLabel: "Mass", time: "12:00 PM", startHour: 12, startMin: 0, durationMin: 45, detail: "Live from the Chapel", hostInitials: "FR", photoGrad: "linear-gradient(170deg, #7A6B52 0%, #5C4F3A 60%, #3D3528 100%)" },
      { id: "chaplet", seriesId: "divine-mercy", label: "Divine Mercy", shortLabel: "Chaplet", time: "3:00 PM", startHour: 15, startMin: 0, durationMin: 20, detail: "The Hour of Mercy", hostInitials: "DM", photoGrad: "linear-gradient(170deg, #4F6275 0%, #3A4F63 60%, #253A4D 100%)" },
      { id: "rosary", seriesId: "family-rosary", label: "Family Rosary", shortLabel: "Rosary", time: "7:00 PM", startHour: 19, startMin: 0, durationMin: 25, detail: "Luminous Mysteries", hostInitials: "FR", photoGrad: "linear-gradient(170deg, #5B6B4F 0%, #3F5233 60%, #2A3B22 100%)" },
    ];

    const WATCH_CATEGORIES = ["All", "Prayer", "Shows", "Catechesis", "Conferences", "Documentaries", "Seasonal"];

    function getWatchLiveState(h, m) {
      const now = h * 60 + m;
      const live = WATCH_PRAYERS.filter(p => { const s = p.startHour * 60 + p.startMin; return now >= s && now < s + p.durationMin; });
      return live.length > 0 ? live[0] : null;
    }
    function getWatchCountdown(p, h, m) {
      const now = h * 60 + m, s = p.startHour * 60 + p.startMin, end = s + p.durationMin;
      if (now >= s && now < end) return { text: "Streaming now", isLive: true, isPast: false };
      if (now >= end) return { text: "Tomorrow " + p.time, isLive: false, isPast: true };
      const diff = s - now, hr = Math.floor(diff / 60), mn = diff % 60;
      return { text: hr > 0 ? "Starts in " + hr + "h " + mn + "m" : "Starts in " + mn + "m", isLive: false, isPast: false };
    }

    const waveHeights = [40, 70, 100, 60, 30];
    const wavePeaks = waveHeights.map(h => (100 / h).toFixed(3));
    const StaticWaveform = ({ animating }) => (
      <div style={{ display: "flex", alignItems: "center", gap: 2.5, height: 16 }}>
        {waveHeights.map((h, i) => (
          <div key={i} style={{ width: 2.2, height: `${h}%`, background: "#fff", borderRadius: 1.5, transformOrigin: "center",
            ...(animating ? { animation: `waveBar 0.45s ease-in-out ${i * 0.07}s both`, '--peak': wavePeaks[i] } : {}) }} />
        ))}
      </div>
    );

    const SearchBar = ({ value, onChange, placeholder, variant = "light" }) => {
      const isLight = variant === "light";
      return (
        <div style={{
          display: "flex", alignItems: "center", gap: 10, padding: "10px 14px", borderRadius: 10,
          background: isLight ? colors.searchBgLight : colors.searchBg, margin: "0 20px",
        }}>
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke={isLight ? colors.textMuted : "rgba(255,255,255,0.5)"} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
            <circle cx="11" cy="11" r="8" /><line x1="21" y1="21" x2="16.65" y2="16.65" />
          </svg>
          <input type="text" value={value} onChange={(e) => onChange(e.target.value)} placeholder={placeholder}
            style={{ background: "none", border: "none", outline: "none", fontFamily: "'DM Sans', sans-serif", fontSize: 13, color: isLight ? colors.text : "#fff", width: "100%" }} />
          {value && (
            <div onClick={() => onChange("")} style={{
              width: 20, height: 20, borderRadius: "50%", background: isLight ? "#ddd" : "rgba(255,255,255,0.2)",
              display: "flex", alignItems: "center", justifyContent: "center", cursor: "pointer", fontSize: 10,
              color: isLight ? colors.textMuted : "rgba(255,255,255,0.6)",
            }}>✕</div>
          )}
        </div>
      );
    };

    const SquareCover = ({ book, onClick }) => (
      <div style={{ flexShrink: 0, width: 140, cursor: "pointer" }} onClick={onClick}>
        <div style={{
          width: 140, height: 140, borderRadius: 10, position: "relative", overflow: "hidden",
          boxShadow: "0 4px 14px rgba(0,0,0,0.2)", background: book.color,
        }}>
          <img src={book.image} alt={book.title} style={{ width: "100%", height: "100%", objectFit: "cover", display: "block" }} />
        </div>
        <div style={{ marginTop: 8, fontFamily: "'DM Sans', sans-serif", fontSize: 11, color: colors.text, fontWeight: 500, lineHeight: 1.3, display: "-webkit-box", WebkitLineClamp: 2, WebkitBoxOrient: "vertical", overflow: "hidden" }}>{book.title}</div>
        <div style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 9, color: colors.textMuted, marginTop: 2 }}>Narrated by {book.narrator}</div>
      </div>
    );

    const ContinueListeningItem = ({ book, progress, timeLeft, onClick }) => (
      <div onClick={onClick} style={{ display: "flex", gap: 8, cursor: "pointer", padding: "6px 10px 6px 6px", background: "#fff", borderRadius: 8, boxShadow: "0 1px 4px rgba(0,0,0,0.08)", minWidth: 0, overflow: "hidden" }}>
        <div style={{ width: 44, height: 44, borderRadius: 5, flexShrink: 0, overflow: "hidden", background: book.color }}>
          <img src={book.image} alt={book.title} style={{ width: "100%", height: "100%", objectFit: "cover", display: "block" }} />
        </div>
        <div style={{ flex: 1, minWidth: 0, display: "flex", flexDirection: "column", justifyContent: "space-between" }}>
          <div style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 12, color: colors.text, fontWeight: 600, lineHeight: 1.3, display: "-webkit-box", WebkitLineClamp: 2, WebkitBoxOrient: "vertical", overflow: "hidden" }}>{book.title}</div>
          <div style={{ display: "flex", alignItems: "center", gap: 5 }}>
            <div style={{ flex: 1, height: 5, background: "#e0e0e0", borderRadius: 3, overflow: "hidden" }}>
              <div style={{ height: "100%", width: `${progress}%`, background: "#2e7d32", borderRadius: 3 }} />
            </div>
            <span style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 10, color: colors.textMuted, whiteSpace: "nowrap", flexShrink: 0 }}>{timeLeft} left</span>
          </div>
        </div>
      </div>
    );

    const GridCover = ({ book, onClick }) => (
      <div style={{ width: "calc(50% - 7px)", cursor: "pointer", marginBottom: 18 }} onClick={onClick}>
        <div style={{
          width: "100%", paddingBottom: "100%", borderRadius: 10, position: "relative", overflow: "hidden",
          boxShadow: "0 4px 14px rgba(0,0,0,0.2)", background: book.color,
        }}>
          <img src={book.image} alt={book.title} style={{ position: "absolute", inset: 0, width: "100%", height: "100%", objectFit: "cover" }} />
        </div>
        <div style={{ marginTop: 8, fontFamily: "'DM Sans', sans-serif", fontSize: 12, color: colors.text, fontWeight: 500, lineHeight: 1.3, display: "-webkit-box", WebkitLineClamp: 2, WebkitBoxOrient: "vertical", overflow: "hidden" }}>{book.title}</div>
        <div style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 9, color: colors.textMuted, marginTop: 2 }}>Narrated by {book.narrator}</div>
      </div>
    );

    const SearchResultItem = ({ book, onClick }) => (
      <div onClick={onClick} style={{ display: "flex", gap: 12, padding: "10px 20px", cursor: "pointer", borderBottom: "1px solid #f0f0f0" }}>
        <div style={{ width: 50, height: 50, borderRadius: 8, flexShrink: 0, overflow: "hidden", background: book.color }}>
          <img src={book.image} alt={book.title} style={{ width: "100%", height: "100%", objectFit: "cover", display: "block" }} />
        </div>
        <div style={{ flex: 1, minWidth: 0 }}>
          <div style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 13, color: colors.text, fontWeight: 600, whiteSpace: "nowrap", overflow: "hidden", textOverflow: "ellipsis" }}>{book.title}</div>
          <div style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 11, color: colors.textMuted, marginTop: 2 }}>{book.author}</div>
          <div style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 10, color: colors.textMuted, marginTop: 1 }}>{book.duration} · {book.narrator}</div>
        </div>
        <div style={{ display: "flex", alignItems: "center" }}>
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke={colors.textMuted} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="9 18 15 12 9 6" /></svg>
        </div>
      </div>
    );

    const HorizontalRow = ({ title, subtitle, books, onSeeAll, onBookClick }) => (
      <div style={{ marginBottom: 8 }}>
        <div style={{ marginBottom: 10, padding: "0 20px" }}>
          <div style={{ display: "flex", justifyContent: "space-between", alignItems: "baseline" }}>
            <div style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 19, fontWeight: 700, color: colors.text, letterSpacing: -0.3 }}>{title}</div>
            <div onClick={onSeeAll} style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 11, color: colors.accent, fontWeight: 600, cursor: "pointer", letterSpacing: 0.3 }}>See All →</div>
          </div>
          {subtitle && <div style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 11, color: colors.textMuted, marginTop: 2 }}>{subtitle}</div>}
        </div>
        <div style={{ display: "flex", gap: 14, overflowX: "auto", padding: "0 20px 8px", scrollbarWidth: "none", msOverflowStyle: "none" }}>
          {books.map((book, i) => <SquareCover key={i} book={book} onClick={() => onBookClick(book)} />)}
        </div>
      </div>
    );

    const TitleDetailPage = ({ book, onBack, onSuggest }) => (
      <div style={{ overflowY: "auto", height: "100%", paddingBottom: 140, scrollbarWidth: "none" }}>
        <div style={{
          background: "linear-gradient(180deg, #0b1e33 0%, #0f2d50 35%, #1e4d7a 65%, #3b6fa0 100%)",
          padding: "16px 20px 44px", display: "flex", flexDirection: "column", alignItems: "center",
        }}>
          <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center", width: "100%", marginBottom: 20 }}>
            <div onClick={onBack} style={{ width: 34, height: 34, borderRadius: "50%", background: "rgba(255,255,255,0.2)", display: "flex", alignItems: "center", justifyContent: "center", cursor: "pointer" }}>
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#fff" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round"><polyline points="15 18 9 12 15 6" /></svg>
            </div>
            <div style={{ width: 34, height: 34, borderRadius: "50%", background: "rgba(255,255,255,0.2)", display: "flex", alignItems: "center", justifyContent: "center", cursor: "pointer" }}>
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#fff" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8" /><polyline points="16 6 12 2 8 6" /><line x1="12" y1="2" x2="12" y2="15" /></svg>
            </div>
          </div>
          <div style={{ width: 180, height: 180, borderRadius: 12, overflow: "hidden", boxShadow: "0 8px 30px rgba(0,0,0,0.35)", background: book.color }}>
            <img src={book.image} alt={book.title} style={{ width: "100%", height: "100%", objectFit: "cover", display: "block" }} />
          </div>
          <div style={{ marginTop: 16, padding: "6px 18px", borderRadius: 20, border: "1.5px solid rgba(255,255,255,0.4)", cursor: "pointer", display: "flex", alignItems: "center", gap: 6 }}>
            <span style={{ fontSize: 10, color: "#fff" }}>▶</span>
            <span style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 12, color: "#fff", fontWeight: 500 }}>Preview</span>
          </div>
          <h2 style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 24, fontWeight: 700, color: "#fff", textAlign: "center", margin: "16px 0 4px", lineHeight: 1.2 }}>{book.title}</h2>
          <span style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 13, color: "rgba(255,255,255,0.6)" }}>{book.duration}</span>
          <div style={{ display: "flex", marginTop: 16, width: "100%", justifyContent: "center" }}>
            <div style={{ textAlign: "center", flex: 1, borderRight: "1px solid rgba(255,255,255,0.2)", paddingRight: 16 }}>
              <div style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 9, color: "rgba(255,255,255,0.5)", letterSpacing: 1, textTransform: "uppercase", marginBottom: 4 }}>By</div>
              <div style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 13, color: "#fff", fontWeight: 500 }}>{book.author}</div>
            </div>
            <div style={{ textAlign: "center", flex: 1, paddingLeft: 16 }}>
              <div style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 9, color: "rgba(255,255,255,0.5)", letterSpacing: 1, textTransform: "uppercase", marginBottom: 4 }}>Narrated By</div>
              <div style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 13, color: "#fff", fontWeight: 500 }}>{book.narrator}</div>
            </div>
          </div>
          <div style={{
            marginTop: 22, padding: "13px 0", borderRadius: 30, background: "#fff", textAlign: "center",
            cursor: "pointer", width: "82%", boxShadow: "0 3px 14px rgba(0,0,0,0.25)",
          }}>
            <span style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 14, color: "#111", fontWeight: 700, display: "flex", alignItems: "center", justifyContent: "center", gap: 8 }}>
              <svg width="16" height="16" viewBox="0 0 24 24" fill="#111"><path d="M8 6.82v10.36c0 .79.87 1.27 1.54.84l8.14-5.18c.62-.39.62-1.29 0-1.69L9.54 5.98C8.87 5.55 8 6.03 8 6.82z"/></svg>
              Create Free Account to Listen
            </span>
          </div>
        </div>
        <div style={{ background: colors.contentBg, borderRadius: "20px 20px 0 0", marginTop: -20, position: "relative", zIndex: 2, padding: "24px 20px", boxShadow: "0 -6px 20px rgba(0,0,0,0.12)" }}>
          <div style={{ marginBottom: 24 }}>
            <h3 style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 18, fontWeight: 700, color: colors.text, margin: "0 0 10px" }}>Summary</h3>
            <p style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 13, color: colors.textMuted, lineHeight: 1.65, margin: 0 }}>{book.summary}</p>
          </div>
          <div style={{ height: 1, background: "#e8e8e8", margin: "0 0 24px" }} />
          <div>
            <h3 style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 18, fontWeight: 700, color: colors.text, margin: "0 0 16px" }}>Details & Credits</h3>
            {[
              { label: "Producer", value: book.credits.producer },
              { label: "Director", value: book.credits.director },
              { label: "Audio Editor", value: book.credits.editor },
              { label: "Sound Design", value: book.credits.sound },
              { label: "Music", value: book.credits.music },
              { label: "Production", value: book.credits.project },
            ].map((credit, i) => (
              <div key={i} style={{
                display: "flex", justifyContent: "space-between", alignItems: "center",
                padding: "10px 0", borderBottom: i < 5 ? "1px solid #f0f0f0" : "none",
              }}>
                <span style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 12, color: colors.textMuted }}>{credit.label}</span>
                <span style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 12, color: colors.text, fontWeight: 500 }}>{credit.value}</span>
              </div>
            ))}
          </div>
          <div style={{ height: 1, background: "#e8e8e8", margin: "24px 0" }} />
          <div>
            <h3 style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 18, fontWeight: 700, color: colors.text, margin: "0 0 14px" }}>You Might Also Enjoy</h3>
            <div style={{ display: "flex", gap: 14 }}>
              {allBooks.filter(b => b.id !== book.id).sort(() => Math.random() - 0.5).slice(0, 2).map((rec, i) => (
                <div key={i} onClick={() => onSuggest(rec)} style={{ flex: 1, cursor: "pointer" }}>
                  <div style={{
                    width: "100%", paddingBottom: "100%", borderRadius: 10, position: "relative", overflow: "hidden",
                    boxShadow: "0 4px 14px rgba(0,0,0,0.2)", background: rec.color,
                  }}>
                    <img src={rec.image} alt={rec.title} style={{ position: "absolute", inset: 0, width: "100%", height: "100%", objectFit: "cover" }} />
                  </div>
                  <div style={{ marginTop: 8, fontFamily: "'DM Sans', sans-serif", fontSize: 11, color: colors.text, fontWeight: 500, lineHeight: 1.3, display: "-webkit-box", WebkitLineClamp: 2, WebkitBoxOrient: "vertical", overflow: "hidden" }}>{rec.title}</div>
                  <div style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 9, color: colors.textMuted, marginTop: 2 }}>{rec.duration}</div>
                </div>
              ))}
            </div>
          </div>
        </div>
      </div>
    );

    const PageHeader = ({ title, onBack, rightElement }) => (
      <div style={{ background: "#4485bc" }}>
        <div style={{ display: "flex", alignItems: "center", gap: 12, padding: "16px 20px 14px" }}>
          <div onClick={onBack} style={{
            width: 32, height: 32, borderRadius: "50%", background: "rgba(255,255,255,0.2)",
            display: "flex", alignItems: "center", justifyContent: "center", cursor: "pointer",
          }}>
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#fff" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round"><polyline points="15 18 9 12 15 6" /></svg>
          </div>
          <h1 style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 24, fontWeight: 700, color: "#fff", margin: 0, letterSpacing: -0.3, flex: 1 }}>{title}</h1>
          {rightElement}
        </div>
      </div>
    );

    const WireBox = ({ width, height, label, style: extraStyle = {} }) => (
      <div style={{
        width, height, background: "#e8e8e8", border: "1.5px solid #d0d0d0",
        borderRadius: 8, display: "flex", alignItems: "center", justifyContent: "center",
        flexShrink: 0, ...extraStyle,
      }}>
        {label && <span style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 9, color: "#b0b0b0", letterSpacing: 0.5 }}>{label}</span>}
      </div>
    );

    const bannerImages = [
      "visual_elements/home_screen_banner_1.PNG",
      "visual_elements/home_screen_banner_3.png",
      "visual_elements/home_screen_banner_4.PNG",
      "visual_elements/home_screen_banner_5.PNG",
    ];

    const articleImages = [
      "visual_elements/home_screen_article.PNG",
      "visual_elements/home_screen_article_2.png",
      "visual_elements/home_screen_article_3.png",
    ];

    const HomeScreen = ({ triggerLive }) => {
      const [bannerIdx, setBannerIdx] = useState(0);
      const [articleIdx, setArticleIdx] = useState(0);
      const touchStartX = useRef(null);
      const articleTouchX = useRef(null);

      useEffect(() => {
        const timer = setInterval(() => {
          setBannerIdx(i => (i + 1) % bannerImages.length);
        }, 5000);
        return () => clearInterval(timer);
      }, []);

      return (
      <div style={{ overflowY: "auto", height: "100%", paddingBottom: 184, scrollbarWidth: "none", background: colors.pageBg }} className="hide-scrollbar">

        {/* Rotating Promotional Banner Carousel */}
        <div
          onTouchStart={e => { touchStartX.current = e.touches[0].clientX; }}
          onTouchEnd={e => {
            if (touchStartX.current === null) return;
            const diff = touchStartX.current - e.changedTouches[0].clientX;
            if (Math.abs(diff) > 40) {
              if (diff > 0) setBannerIdx(i => (i + 1) % bannerImages.length);
              else setBannerIdx(i => (i - 1 + bannerImages.length) % bannerImages.length);
            }
            touchStartX.current = null;
          }}
          style={{ cursor: "pointer", overflow: "hidden" }}
        >
          <img src={bannerImages[bannerIdx]} alt="Promotional banner" style={{ width: "100%", display: "block" }} />
        </div>

        {/* Featured Tiles Row */}
        <div style={{ padding: "10px 10px 0" }}>
          <div style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 16, fontWeight: 700, color: "#1a3a5c", marginBottom: 6 }}>Featured</div>
          <div style={{ display: "flex", gap: 8 }}>
            {[
              { label: "Listen Live", image: "rr_shows/morning_air.jpg" },
              { label: "Lent with the Sai...", image: "rr_shows/lent_with_the_saints.jpeg" },
              { label: "Lenten Lessons on the Mass", image: "rr_shows/lenten_lessons_on_the_mass.png" },
            ].map((tile, i) => (
              <div key={i} onClick={tile.label === "Listen Live" ? triggerLive : undefined} style={{ flex: 1, cursor: "pointer", minWidth: 0 }}>
                <div style={{ width: "100%", paddingBottom: "100%", borderRadius: 10, overflow: "hidden", boxShadow: "0 2px 8px rgba(0,0,0,0.12)", position: "relative" }}>
                  <img src={tile.image} alt={tile.label} style={{ position: "absolute", inset: 0, width: "100%", height: "100%", objectFit: "cover", display: "block" }} />
                </div>
                <div style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 12, fontWeight: 500, color: colors.text, marginTop: 5, lineHeight: 1.3, overflow: "hidden", textOverflow: "ellipsis", whiteSpace: "nowrap" }}>{tile.label}</div>
              </div>
            ))}
          </div>
        </div>

        {/* Hero Article Card */}
        <div style={{ marginTop: 14 }}>
          <div
            onTouchStart={e => { articleTouchX.current = e.touches[0].clientX; }}
            onTouchEnd={e => {
              if (articleTouchX.current === null) return;
              const diff = articleTouchX.current - e.changedTouches[0].clientX;
              if (Math.abs(diff) > 40) {
                if (diff > 0) setArticleIdx(i => (i + 1) % articleImages.length);
                else setArticleIdx(i => (i - 1 + articleImages.length) % articleImages.length);
              }
              articleTouchX.current = null;
            }}
            style={{ cursor: "pointer" }}
          >
            <img src={articleImages[articleIdx]} alt="Featured article" style={{ width: "100%", display: "block" }} />
          </div>
          {/* Dots left, VIEW ALL right — below image */}
          <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center", padding: "8px 12px" }}>
            <div style={{ display: "flex", gap: 6 }}>
              {articleImages.map((_, i) => (
                <div key={i} onClick={() => setArticleIdx(i)} style={{ width: 8, height: 8, borderRadius: "50%", background: i === articleIdx ? "#d32f2f" : "#ccc", cursor: "pointer" }} />
              ))}
            </div>
            <div style={{ display: "flex", alignItems: "center", gap: 5, cursor: "pointer" }}>
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke={colors.textMuted} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/></svg>
              <span style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 11, fontWeight: 600, color: colors.textMuted, letterSpacing: 0.3 }}>VIEW ALL</span>
            </div>
          </div>
        </div>

      </div>
    );
    };

    // ═══ WATCH TAB — ICONS ═══
    const WatchSearchIcon = ({ size = 16 }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round"><circle cx="11" cy="11" r="8" /><line x1="21" y1="21" x2="16.65" y2="16.65" /></svg>
    );
    const WatchPlayFill = ({ size = 20, color = "#fff" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none"><path d="M8 5.14v13.72a1 1 0 001.5.86l11.04-6.86a1 1 0 000-1.72L9.5 4.28A1 1 0 008 5.14z" fill={color} /></svg>
    );

    // ═══ WATCH TAB — PRIMITIVES ═══
    const WatchProgressBar = ({ progress }) => {
      if (!progress || progress <= 0) return null;
      return (
        <div style={{ position: "absolute", bottom: 0, left: 0, right: 0, height: 3, background: "rgba(0,0,0,0.15)" }}>
          <div style={{ width: (Math.min(progress, 1) * 100) + "%", height: "100%", background: wC.gold, borderRadius: "0 2px 2px 0" }} />
        </div>
      );
    };

    // ═══ WATCH TAB — HERO BILLBOARD ═══
    const HERO_SLIDES = [
      { title: "Lenten Lessons on the Mass", subtitle: "Fr. Rocky · 40 episodes", gradient: "linear-gradient(140deg, #EDE6F5, #D8CEE8)", seriesId: "lenten-mass" },
      { title: "SEEK 2026", subtitle: "24 talks · Watch the full series", gradient: "linear-gradient(140deg, #E8E0F0, #D8D0E8)", seriesId: "seek-2026" },
      { title: "Life Is Worth Living", subtitle: "Fulton Sheen · Ep. 4 of 12", gradient: "linear-gradient(140deg, #E8E4F0, #D0C8E0)", seriesId: "fulton-sheen", isContinue: true, progress: 0.65 },
      { title: "Into the Breach", subtitle: "Knights of Columbus · Ep. 2 of 8", gradient: "linear-gradient(140deg, #E8E4E0, #D8D0C8)", seriesId: "into-the-breach", isContinue: true, progress: 0.38 },
    ];

    const HeroBillboard = ({ liveNow, onTapSeries }) => {
      const [hover, setHover] = useState(false);
      const [activeSlide, setActiveSlide] = useState(0);

      // Live mode
      if (liveNow) {
        return (
          <div style={{ padding: "0 16px" }}>
            <div onMouseEnter={() => setHover(true)} onMouseLeave={() => setHover(false)}
              style={{ borderRadius: 16, overflow: "hidden", cursor: "pointer", background: wC.liveBg, border: "1px solid rgba(212,51,51,0.12)", boxShadow: hover ? wC.shadowMd : wC.shadow, transition: "all 0.2s" }}>
              <div style={{ height: 170, position: "relative", background: "linear-gradient(140deg, #F5E8E8, #E8DDDD)", display: "flex", alignItems: "center", justifyContent: "center" }}>
                <div style={{ width: 56, height: 56, borderRadius: "50%", background: wC.live, display: "flex", alignItems: "center", justifyContent: "center", boxShadow: "0 4px 16px rgba(212,51,51,0.25)", transform: hover ? "scale(1.06)" : "scale(1)", transition: "transform 0.15s" }}>
                  <WatchPlayFill size={24} />
                </div>
                <div style={{ position: "absolute", top: 12, right: 12, display: "flex", alignItems: "center", gap: 5, background: wC.live, borderRadius: 20, padding: "4px 12px" }}>
                  <div style={{ width: 6, height: 6, borderRadius: "50%", background: "#fff", animation: "pulse 2s ease-in-out infinite" }} />
                  <span style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 10, fontWeight: 800, color: "#fff", letterSpacing: 1 }}>LIVE</span>
                </div>
              </div>
              <div style={{ padding: "14px 16px 16px" }}>
                <h2 style={{ margin: 0, fontFamily: "'DM Sans', sans-serif", fontSize: 20, fontWeight: 800, color: wC.text1, letterSpacing: -0.3 }}>{liveNow.label}</h2>
                <p style={{ margin: "4px 0 0", fontFamily: "'DM Sans', sans-serif", fontSize: 12, color: wC.live, fontWeight: 500 }}>{liveNow.detail} · Streaming now</p>
              </div>
            </div>
          </div>
        );
      }

      // Carousel mode
      const slide = HERO_SLIDES[activeSlide];
      return (
        <div style={{ padding: "0 16px" }}>
          <div style={{ position: "relative" }}>
            <div onClick={() => onTapSeries(slide.seriesId)} onMouseEnter={() => setHover(true)} onMouseLeave={() => setHover(false)}
              style={{ borderRadius: 16, overflow: "hidden", cursor: "pointer", background: wC.card, border: "1px solid " + wC.border, boxShadow: hover ? wC.shadowMd : wC.shadow, transition: "all 0.2s" }}>
              <div style={{ height: 170, position: "relative", background: slide.gradient, display: "flex", alignItems: "center", justifyContent: "center", transition: "background 0.4s" }}>
                <div style={{ width: 56, height: 56, borderRadius: "50%", background: slide.isContinue ? "rgba(0,0,0,0.45)" : "rgba(0,0,0,0.06)", border: slide.isContinue ? "none" : "1.5px solid rgba(0,0,0,0.08)", display: "flex", alignItems: "center", justifyContent: "center", transform: hover ? "scale(1.06)" : "scale(1)", transition: "transform 0.15s" }}>
                  <WatchPlayFill size={22} color={slide.isContinue ? "#fff" : "rgba(0,0,0,0.25)"} />
                </div>
                {slide.isContinue && (
                  <div style={{ position: "absolute", top: 12, right: 12, background: "rgba(0,0,0,0.55)", borderRadius: 20, padding: "4px 12px", backdropFilter: "blur(4px)" }}>
                    <span style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 9, fontWeight: 700, color: "#fff", letterSpacing: 0.5 }}>CONTINUE</span>
                  </div>
                )}
                {slide.isContinue && slide.progress && <WatchProgressBar progress={slide.progress} />}
              </div>
              <div style={{ padding: "14px 16px 16px" }}>
                <h2 style={{ margin: 0, fontFamily: "'DM Sans', sans-serif", fontSize: 20, fontWeight: 800, color: wC.text1, letterSpacing: -0.3 }}>{slide.title}</h2>
                <p style={{ margin: "4px 0 0", fontFamily: "'DM Sans', sans-serif", fontSize: 12, color: wC.text2 }}>{slide.subtitle}</p>
              </div>
            </div>
            <div style={{ display: "flex", justifyContent: "center", gap: 6, marginTop: 10 }}>
              {HERO_SLIDES.map((_, i) => (
                <div key={i} onClick={(e) => { e.stopPropagation(); setActiveSlide(i); }}
                  style={{ width: activeSlide === i ? 18 : 6, height: 6, borderRadius: 3, background: activeSlide === i ? wC.gold : wC.text4, cursor: "pointer", transition: "all 0.25s" }} />
              ))}
            </div>
          </div>
        </div>
      );
    };

    // ═══ WATCH TAB — WATCH HOME ═══
    const WatchHome = ({ onNavigate, onTapSeries }) => {
      const [demoLive, setDemoLive] = useState(false);
      const now = new Date();
      const realLive = getWatchLiveState(now.getHours(), now.getMinutes());
      // When demo toggle is on, simulate 7:10 PM (Rosary live)
      const liveNow = demoLive ? getWatchLiveState(19, 10) : realLive;

      return (
        <div style={{ height: "100%", overflowY: "auto", background: wC.bg, paddingBottom: 80 }} className="hide-scrollbar">
          {/* Watch Home Header */}
          <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center", padding: "14px 18px 12px" }}>
            <div style={{ display: "flex", alignItems: "center", gap: 10 }}>
              <h1 style={{ margin: 0, fontFamily: "'DM Sans', sans-serif", fontSize: 26, fontWeight: 800, color: wC.text1, letterSpacing: -0.5 }}>Watch</h1>
              <div onClick={() => setDemoLive(!demoLive)} style={{ display: "flex", alignItems: "center", gap: 4, padding: "4px 10px", borderRadius: 20, cursor: "pointer", background: demoLive ? wC.live : wC.surface, border: demoLive ? "1px solid " + wC.live : "1px solid " + wC.border, transition: "all 0.2s" }}>
                {demoLive && <div style={{ width: 5, height: 5, borderRadius: "50%", background: "#fff", animation: "pulse 2s ease-in-out infinite" }} />}
                <span style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 9, fontWeight: 700, color: demoLive ? "#fff" : wC.text3, letterSpacing: 0.5 }}>LIVE</span>
              </div>
            </div>
            <div style={{ display: "flex", alignItems: "center", gap: 12 }}>
              <span onClick={() => onNavigate("allSeries")} style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 13, fontWeight: 600, color: wC.goldText, cursor: "pointer" }}>All Series</span>
              <div style={{ width: 34, height: 34, borderRadius: 10, background: wC.surface, border: "1px solid " + wC.border, display: "flex", alignItems: "center", justifyContent: "center", cursor: "pointer", color: wC.text3 }}>
                <WatchSearchIcon size={16} />
              </div>
            </div>
          </div>
          {/* Hero Billboard */}
          <HeroBillboard liveNow={liveNow} onTapSeries={onTapSeries} />
          <div style={{ height: 12 }} />
          {/* More sections will be added in subsequent tasks */}
        </div>
      );
    };

    function AudiobooksApp() {
      const [activeTab, setActiveTab] = useState("home");
      const [view, setView] = useState("main");
      const [selectedBook, setSelectedBook] = useState(null);
      const [categorySearch, setCategorySearch] = useState("");
      const [allTitlesSearch, setAllTitlesSearch] = useState("");
      const [mainSearchOpen, setMainSearchOpen] = useState(false);
      const [mainSearch, setMainSearch] = useState("");
      const [previousView, setPreviousView] = useState("main");
      const [settingsOpen, setSettingsOpen] = useState(false);
      const [livePlayerOpen, setLivePlayerOpen] = useState(false);
      const [listenView, setListenView] = useState("landing");
      const [watchView, setWatchView] = useState("home");
      const [selectedSeries, setSelectedSeries] = useState(null);
      const [liveAnimating, setLiveAnimating] = useState(false);
      const triggerLive = () => { setActiveTab("live"); setLivePlayerOpen(true); setLiveAnimating(true); setTimeout(() => setLiveAnimating(false), 900); };
      const goToWatchSeries = (seriesId) => {
        const series = WATCH_SERIES.find(s => s.id === seriesId);
        if (series) { setSelectedSeries(series); setWatchView("seriesDetail"); }
      };
      const [autoplayLive, setAutoplayLive] = useState(false);
      const [autoplayPodcast, setAutoplayPodcast] = useState(true);
      const [pushNotifs, setPushNotifs] = useState(true);

      const openBook = (book) => { setPreviousView(view); setSelectedBook(book); setView("detail"); };
      const goBack = () => {
        if (view === "detail") { setSelectedBook(null); setView(previousView); }
        else { setView("main"); setCategorySearch(""); setAllTitlesSearch(""); setMainSearchOpen(false); setMainSearch(""); }
      };

      const searchBooks = (books, query) => {
        if (!query.trim()) return books;
        const q = query.toLowerCase();
        return books.filter(b => b.title.toLowerCase().includes(q) || b.author.toLowerCase().includes(q) || b.narrator.toLowerCase().includes(q));
      };

      const filteredAllTitles = useMemo(() => searchBooks(allBooks, allTitlesSearch), [allTitlesSearch]);

      return (
        <div style={{
          width: 375, height: 812, margin: "20px auto",
          background: activeTab === "watch" ? wC.bg : (activeTab !== "home" && view === "detail") ? "#0b1e33" : colors.pageBg,
          borderRadius: 40, overflow: "hidden", position: "relative",
          boxShadow: "0 20px 60px rgba(0,0,0,0.3), 0 0 0 2px rgba(0,0,0,0.08)",
          fontFamily: "'DM Sans', sans-serif",
        }}>
          <style>{`.hide-scrollbar::-webkit-scrollbar{display:none}input::placeholder{color:${colors.textMuted}!important}.search-dark input::placeholder{color:rgba(255,255,255,0.4)!important}`}</style>

          {/* Header: status bar strip + logo section with RR icon button */}
          <div style={{ background: "#3b6394" }}>
            {/* Status bar strip */}
            <img src="current_app_state/header_strip.png" style={{ width: "100%", display: "block" }} />
            {/* Logo area — fixed height to match header_full total */}
            <div style={{ position: "relative", height: 79, display: "flex", alignItems: "center", justifyContent: "center" }}>
              <img src="current_app_state/header_logo.png" style={{ height: "100%", objectFit: "contain", display: "block" }} />
              {/* Back arrow — only when More screen is open */}
              {settingsOpen && (
                <div onClick={() => setSettingsOpen(false)} style={{
                  position: "absolute", left: 12, top: "50%", transform: "translateY(-50%)",
                  cursor: "pointer",
                  width: 34, height: 34, borderRadius: "50%",
                  background: "rgba(255,255,255,0.2)",
                  display: "flex", alignItems: "center", justifyContent: "center",
                }}>
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#fff" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round"><polyline points="15 18 9 12 15 6"/></svg>
                </div>
              )}
              {/* Profile icon button */}
              <div onClick={() => setSettingsOpen(true)} style={{
                position: "absolute", right: 12, top: "50%", transform: "translateY(-50%)",
                cursor: "pointer",
                width: 34, height: 34, borderRadius: "50%",
                background: "rgba(255,255,255,0.2)",
                display: "flex", alignItems: "center", justifyContent: "center",
              }}>
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#fff" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
              </div>
            </div>
          </div>

          <div style={{ height: 560, overflow: "hidden" }}>
            {settingsOpen ? (
              (() => {
                const Toggle = ({ on, onToggle }) => (
                  <div onClick={onToggle} style={{
                    width: 50, height: 30, borderRadius: 15, background: on ? "#34c759" : "#ccc",
                    position: "relative", cursor: "pointer", flexShrink: 0, transition: "background 0.2s",
                  }}>
                    <div style={{
                      position: "absolute", top: 3, left: on ? 23 : 3, width: 24, height: 24,
                      borderRadius: "50%", background: "#fff", boxShadow: "0 1px 4px rgba(0,0,0,0.25)",
                      transition: "left 0.2s",
                    }} />
                  </div>
                );
                const menuItems = [
                  { label: "Find a Station", icon: <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke={colors.textMuted} strokeWidth="1.8" strokeLinecap="round" strokeLinejoin="round"><path d="M5 12.55a11 11 0 0 1 14.08 0"/><path d="M1.42 9a16 16 0 0 1 21.16 0"/><path d="M8.53 16.11a6 6 0 0 1 6.95 0"/><circle cx="12" cy="20" r="1" fill={colors.textMuted} stroke="none"/></svg> },
                  { label: "Live Show Schedule", icon: <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke={colors.textMuted} strokeWidth="1.8" strokeLinecap="round" strokeLinejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg> },
                  { label: "Contact", icon: <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke={colors.textMuted} strokeWidth="1.8" strokeLinecap="round" strokeLinejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07A19.5 19.5 0 0 1 4.69 12 19.79 19.79 0 0 1 1.61 3.36 2 2 0 0 1 3.59 1h3a2 2 0 0 1 2 1.72c.127.96.361 1.903.7 2.81a2 2 0 0 1-.45 2.11L7.91 8.56a16 16 0 0 0 5.55 5.55l.92-.92a2 2 0 0 1 2.11-.45c.907.339 1.85.573 2.81.7A2 2 0 0 1 22 16.92z"/></svg> },
                  { label: "My Downloads", icon: <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke={colors.textMuted} strokeWidth="1.8" strokeLinecap="round" strokeLinejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg> },
                  { label: "Parish Ambassadors", icon: <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke={colors.textMuted} strokeWidth="1.8" strokeLinecap="round" strokeLinejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg> },
                  { label: "About", icon: <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke={colors.textMuted} strokeWidth="1.8" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg> },
                ];
                return (
                  <div style={{ height: "100%", display: "flex", flexDirection: "column", background: "#fff" }}>
                    <div style={{ flex: 1, overflowY: "auto", scrollbarWidth: "none" }} className="hide-scrollbar">
                      <div style={{ padding: "16px 20px 4px" }}>
                        <div style={{
                          background: colors.headerBg, borderRadius: 10, padding: "14px 20px",
                          display: "flex", alignItems: "center", justifyContent: "space-between",
                          cursor: "pointer", marginBottom: 10,
                        }}>
                          <span style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 16, fontWeight: 600, color: "#fff" }}>Prayer Requests</span>
                          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="rgba(255,255,255,0.7)" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round"><polyline points="9 18 15 12 9 6"/></svg>
                        </div>
                        <div style={{
                          background: "#d32f2f", borderRadius: 10, padding: "14px 20px",
                          display: "flex", alignItems: "center", justifyContent: "space-between",
                          cursor: "pointer",
                        }}>
                          <span style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 16, fontWeight: 600, color: "#fff" }}>Give Now</span>
                          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="rgba(255,255,255,0.7)" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round"><polyline points="9 18 15 12 9 6"/></svg>
                        </div>
                      </div>
                      <div style={{ marginTop: 8 }}>
                        {menuItems.map((item, i) => (
                          <div key={i} style={{
                            display: "flex", alignItems: "center", gap: 14, padding: "14px 20px",
                            borderBottom: "1px solid #f0f0f0", cursor: "pointer",
                          }}>
                            <div style={{ flexShrink: 0 }}>{item.icon}</div>
                            <span style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 15, color: colors.text, flex: 1 }}>{item.label}</span>
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke={colors.textMuted} strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round"><polyline points="9 18 15 12 9 6"/></svg>
                          </div>
                        ))}
                      </div>
                      <div style={{ padding: "16px 20px 6px", fontFamily: "'DM Sans', sans-serif", fontSize: 11, fontWeight: 700, color: colors.textMuted, letterSpacing: 1, textTransform: "uppercase" }}>Settings</div>
                      {[
                        { label: "Autoplay Live Stream Upon Open", value: autoplayLive, set: setAutoplayLive },
                        { label: "Autoplay Next Podcast or Audio Prayer", value: autoplayPodcast, set: setAutoplayPodcast },
                        { label: "Allow Push Notifications", value: pushNotifs, set: setPushNotifs },
                      ].map((setting, i, arr) => (
                        <div key={i} style={{
                          display: "flex", alignItems: "center", padding: "14px 20px",
                          borderBottom: i < arr.length - 1 ? "1px solid #f0f0f0" : "none",
                        }}>
                          <span style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 15, color: colors.text, flex: 1, paddingRight: 16 }}>{setting.label}</span>
                          <Toggle on={setting.value} onToggle={() => setting.set(v => !v)} />
                        </div>
                      ))}
                      <div style={{ padding: "32px 20px 24px", textAlign: "center", fontFamily: "'DM Sans', sans-serif", fontSize: 11, color: colors.textMuted, lineHeight: 1.7 }}>
                        Relevant Radio Version: 5.20.0 (1)<br />© Relevant Radio, Inc.
                      </div>
                    </div>
                  </div>
                );
              })()
            ) : activeTab === "home" ? (
              <HomeScreen triggerLive={triggerLive} />
            ) : activeTab === "pray" ? (
              <div style={{ height: "100%", display: "flex", alignItems: "center", justifyContent: "center", background: colors.pageBg }}>
                <span style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 14, color: colors.textMuted }}>Pray — coming soon</span>
              </div>
            ) : activeTab === "watch" ? (
              <WatchHome onNavigate={setWatchView} onTapSeries={goToWatchSeries} />
            ) : activeTab === "listen" && listenView === "landing" ? (
              <div style={{ height: "100%", background: colors.pageBg }}>
                <div style={{ background: colors.headerBg, padding: "16px 20px 14px" }}>
                  <span style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 24, fontWeight: 700, color: "#fff" }}>Listen</span>
                </div>
                <div style={{ padding: "20px 16px" }}>
                  <div onClick={() => setListenView("audiobooks")} style={{ background: "#fff", borderRadius: 12, padding: "16px 18px", display: "flex", alignItems: "center", gap: 14, cursor: "pointer", boxShadow: "0 1px 4px rgba(0,0,0,0.08)" }}>
                    <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke={colors.headerBg} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 18v-6a9 9 0 0 1 18 0v6"/><path d="M21 19a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3z"/><path d="M3 19a2 2 0 0 0 2 2h1a2 2 0 0 0 2-2v-3a2 2 0 0 0-2-2H3z"/></svg>
                    <span style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 16, fontWeight: 600, color: colors.text, flex: 1 }}>Audiobooks</span>
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke={colors.textMuted} strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round"><polyline points="9 18 15 12 9 6"/></svg>
                  </div>
                </div>
              </div>
            ) : view === "detail" && selectedBook ? (
              <TitleDetailPage book={selectedBook} onBack={goBack} onSuggest={openBook} />
            ) : (
              <div style={{ overflowY: "auto", height: "100%", paddingBottom: 140, scrollbarWidth: "none" }} className="hide-scrollbar">

                {view === "main" && (
                  <>
                    <PageHeader title="Audiobooks" onBack={() => setListenView("landing")}
                      rightElement={
                        <div style={{ display: "flex", alignItems: "center", gap: 14 }}>
                          <div onClick={() => { setMainSearchOpen(o => !o); setMainSearch(""); }} style={{ cursor: "pointer", display: "flex", alignItems: "center", opacity: 0.75 }}>
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#fff" strokeWidth="2.2" strokeLinecap="round" strokeLinejoin="round">
                              <circle cx="11" cy="11" r="8" /><line x1="21" y1="21" x2="16.65" y2="16.65" />
                            </svg>
                          </div>
                          <div onClick={() => { setView("allTitles"); setAllTitlesSearch(""); }} style={{
                            fontFamily: "'DM Sans', sans-serif", fontSize: 12, color: "rgba(255,255,255,0.7)",
                            fontWeight: 600, cursor: "pointer", whiteSpace: "nowrap",
                          }}>All Titles →</div>
                        </div>
                      }
                    />
                    {mainSearchOpen && (
                      <div style={{ background: "#4485bc", paddingBottom: 16 }} className="search-dark">
                        <SearchBar value={mainSearch} onChange={setMainSearch} placeholder="Search all titles..." variant="dark" />
                      </div>
                    )}
                    {mainSearchOpen && mainSearch.trim() ? (
                      <div style={{ background: colors.contentBg, minHeight: 400 }}>
                        <div style={{ padding: "14px 20px 8px", fontFamily: "'DM Sans', sans-serif", fontSize: 12, color: colors.textMuted }}>
                          {searchBooks(allBooks, mainSearch).length} result{searchBooks(allBooks, mainSearch).length !== 1 ? "s" : ""} for "{mainSearch}"
                        </div>
                        {searchBooks(allBooks, mainSearch).length > 0 ? searchBooks(allBooks, mainSearch).map((book, i) => <SearchResultItem key={i} book={book} onClick={() => openBook(book)} />) : (
                          <div style={{ padding: "40px 20px", textAlign: "center", fontFamily: "'DM Sans', sans-serif", fontSize: 14, color: colors.textMuted }}>No audiobooks found</div>
                        )}
                      </div>
                    ) : (
                      <div style={{ padding: "12px 0 0" }}>
                        {/* Continue Listening — 2x2 grid */}
                        <div style={{ marginBottom: 8 }}>
                          <div style={{ padding: "0 20px", marginBottom: 6 }}>
                            <div style={{ display: "flex", justifyContent: "space-between", alignItems: "baseline" }}>
                              <div style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 19, fontWeight: 700, color: colors.text, letterSpacing: -0.3 }}>Continue Listening</div>
                              <div onClick={() => setView("allContinueListening")} style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 11, color: colors.accent, fontWeight: 600, cursor: "pointer", letterSpacing: 0.3 }}>See All →</div>
                            </div>
                          </div>
                          <div style={{ display: "grid", gridTemplateColumns: "1fr 1fr", gap: "8px 10px", padding: "0 20px 8px" }}>
                            {continueListeningData.slice(0, 4).map((item, i) => (
                              <ContinueListeningItem key={i} book={item.book} progress={item.progress} timeLeft={item.timeLeft} onClick={() => openBook(item.book)} />
                            ))}
                          </div>
                        </div>
                        <HorizontalRow title="Spiritual Reading" books={audiobooks.spiritual} onSeeAll={() => { setView("allSpiritual"); setCategorySearch(""); }} onBookClick={openBook} />
                        <HorizontalRow title="Classic Fiction" subtitle="from The Merry Beggars" books={audiobooks.fiction} onSeeAll={() => { setView("allFiction"); setCategorySearch(""); }} onBookClick={openBook} />
                      </div>
                    )}
                  </>
                )}

                {(view === "allSpiritual" || view === "allFiction") && (() => {
                  const categoryBooks = view === "allSpiritual" ? audiobooks.spiritual : audiobooks.fiction;
                  const filtered = searchBooks(categoryBooks, categorySearch);
                  const isSearchingCategory = categorySearch.trim().length > 0;
                  return (
                    <>
                      <PageHeader title={view === "allSpiritual" ? "Spiritual Reading" : "Classic Fiction"} onBack={goBack} />
                      <div style={{ background: "#4485bc", paddingBottom: 16 }} className="search-dark">
                        <SearchBar value={categorySearch} onChange={setCategorySearch} placeholder={`Search ${view === "allSpiritual" ? "spiritual reading" : "fiction"}...`} variant="dark" />
                      </div>
                      {isSearchingCategory ? (
                        <div style={{ background: colors.contentBg, minHeight: 400 }}>
                          <div style={{ padding: "14px 20px 8px", fontFamily: "'DM Sans', sans-serif", fontSize: 12, color: colors.textMuted }}>
                            {filtered.length} result{filtered.length !== 1 ? "s" : ""} for "{categorySearch}"
                          </div>
                          {filtered.length > 0 ? filtered.map((book, i) => <SearchResultItem key={i} book={book} onClick={() => openBook(book)} />) : (
                            <div style={{ padding: "40px 20px", textAlign: "center", fontFamily: "'DM Sans', sans-serif", fontSize: 14, color: colors.textMuted }}>No titles found</div>
                          )}
                        </div>
                      ) : (
                        <div style={{ display: "flex", flexWrap: "wrap", gap: 14, padding: "16px 20px" }}>
                          {categoryBooks.map((book, i) => <GridCover key={i} book={book} onClick={() => openBook(book)} />)}
                        </div>
                      )}
                    </>
                  );
                })()}

                {view === "allContinueListening" && (
                  <div style={{ background: colors.contentBg, minHeight: 400 }}>
                    <PageHeader title="Continue Listening" onBack={goBack} />
                    <div>
                      {continueListeningData.map((item, i) => (
                        <div key={i} onClick={() => openBook(item.book)} style={{ display: "flex", gap: 12, padding: "10px 20px", cursor: "pointer", borderBottom: "1px solid #f0f0f0" }}>
                          <div style={{ width: 50, height: 50, borderRadius: 8, flexShrink: 0, overflow: "hidden", background: item.book.color }}>
                            <img src={item.book.image} alt={item.book.title} style={{ width: "100%", height: "100%", objectFit: "cover", display: "block" }} />
                          </div>
                          <div style={{ flex: 1, minWidth: 0 }}>
                            <div style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 13, color: colors.text, fontWeight: 600, whiteSpace: "nowrap", overflow: "hidden", textOverflow: "ellipsis" }}>{item.book.title}</div>
                            <div style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 11, color: colors.textMuted, marginTop: 2 }}>{item.book.author}</div>
                            <div style={{ display: "flex", alignItems: "center", gap: 8, marginTop: 4 }}>
                              <div style={{ flex: 1, height: 4, background: "#e0e0e0", borderRadius: 2, overflow: "hidden" }}>
                                <div style={{ height: "100%", width: `${item.progress}%`, background: "#2e7d32", borderRadius: 2 }} />
                              </div>
                              <span style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 10, color: colors.textMuted, whiteSpace: "nowrap", flexShrink: 0 }}>{item.timeLeft} left</span>
                            </div>
                          </div>
                          <div style={{ display: "flex", alignItems: "center" }}>
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke={colors.textMuted} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="9 18 15 12 9 6" /></svg>
                          </div>
                        </div>
                      ))}
                    </div>
                  </div>
                )}

                {view === "allTitles" && (
                  <>
                    <PageHeader title="All Titles" onBack={goBack} />
                    <div style={{ background: "#4485bc", paddingBottom: 16 }} className="search-dark">
                      <SearchBar value={allTitlesSearch} onChange={setAllTitlesSearch} placeholder="Search all titles..." variant="dark" />
                    </div>
                    {allTitlesSearch.trim().length > 0 ? (
                      <div style={{ background: colors.contentBg, minHeight: 400 }}>
                        <div style={{ padding: "14px 20px 8px", fontFamily: "'DM Sans', sans-serif", fontSize: 12, color: colors.textMuted }}>
                          {filteredAllTitles.length} result{filteredAllTitles.length !== 1 ? "s" : ""} for "{allTitlesSearch}"
                        </div>
                        {filteredAllTitles.length > 0 ? filteredAllTitles.map((book, i) => <SearchResultItem key={i} book={book} onClick={() => openBook(book)} />) : (
                          <div style={{ padding: "40px 20px", textAlign: "center", fontFamily: "'DM Sans', sans-serif", fontSize: 14, color: colors.textMuted }}>No titles found</div>
                        )}
                      </div>
                    ) : (
                      <div style={{ display: "flex", flexWrap: "wrap", gap: 14, padding: "16px 20px" }}>
                        {allBooks.map((book, i) => <GridCover key={i} book={book} onClick={() => openBook(book)} />)}
                      </div>
                    )}
                  </>
                )}
              </div>
            )}
          </div>

          {/* Sponsor Banner — home screen only */}
          {activeTab === "home" && (
            <div style={{
              position: "absolute", bottom: 72, left: 0, right: 0,
              zIndex: 10, cursor: "pointer", lineHeight: 0,
            }}>
              <img src="visual_elements/home_screen_sponsor_banner.PNG" alt="Charity Mobile — Pro-Life Cell Phone Service" style={{ width: "100%", display: "block" }} />
            </div>
          )}

          {/* Now Playing bar */}
          <div onClick={() => { setActiveTab("live"); setLivePlayerOpen(true); }} style={{
            position: "absolute", bottom: activeTab === "home" ? 128 : 72, left: 0, right: 0,
            background: "linear-gradient(135deg, #1b5e20, #2e7d32)",
            display: "flex", alignItems: "center", justifyContent: "space-between",
            padding: "10px 14px 10px 10px", zIndex: 10, cursor: "pointer",
          }}>
            <div style={{ display: "flex", alignItems: "center", gap: 12 }}>
              <div style={{ width: 60, height: 60, flexShrink: 0, overflow: "hidden", borderRadius: 10 }}>
                <img src="rr_shows/morning_air.jpg" alt="Morning Air" style={{ width: "100%", height: "100%", objectFit: "cover", display: "block" }} />
              </div>
              <div>
                <div style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 9, color: "rgba(255,255,255,0.7)", fontWeight: 700, letterSpacing: 1, textTransform: "uppercase", marginBottom: 3 }}>Listen Live · Now Playing</div>
                <div style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 15, color: "#fff", fontWeight: 700 }}>Morning Air</div>
              </div>
            </div>
            <div style={{ width: 38, height: 38, borderRadius: "50%", background: "#fff", display: "flex", alignItems: "center", justifyContent: "center", cursor: "pointer", flexShrink: 0 }}>
              <svg width="19" height="19" viewBox="0 0 24 24" fill="#2e7d32"><path d="M8 6.82v10.36c0 .79.87 1.27 1.54.84l8.14-5.18c.62-.39.62-1.29 0-1.69L9.54 5.98C8.87 5.55 8 6.03 8 6.82z"/></svg>
            </div>
          </div>

          {/* Bottom nav — 5 evenly-spaced flex items */}
          <div style={{
            position: "absolute", bottom: 0, left: 0, right: 0, height: 72,
            background: "#3f6080",
            display: "flex", alignItems: "center",
            paddingBottom: 8, zIndex: 10,
          }}>
            {/* HOME */}
            <div onClick={() => { setActiveTab("home"); setLivePlayerOpen(false); setSettingsOpen(false); }} style={{ flex: 1, display: "flex", flexDirection: "column", alignItems: "center", gap: 4, cursor: "pointer", color: activeTab === "home" ? "#fff" : "rgba(255,255,255,0.5)" }}>
              <img src="visual_elements/nav_bar_bottom/noun-home-button-8216844-FFFFFF.png" style={{ width: 24, height: 24, opacity: activeTab === "home" ? 1 : 0.5 }} />
              <span style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 9, fontWeight: 700, letterSpacing: 0.5 }}>HOME</span>
            </div>
            {/* LISTEN */}
            <div onClick={() => { setActiveTab("listen"); setListenView("landing"); setView("main"); setMainSearchOpen(false); setMainSearch(""); setLivePlayerOpen(false); setSettingsOpen(false); }} style={{ flex: 1, display: "flex", flexDirection: "column", alignItems: "center", gap: 4, cursor: "pointer", color: activeTab === "listen" ? "#fff" : "rgba(255,255,255,0.5)" }}>
              <img src="visual_elements/nav_bar_bottom/noun-headphone-6065706-FFFFFF.png" style={{ width: 24, height: 24, opacity: activeTab === "listen" ? 1 : 0.5 }} />
              <span style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 9, fontWeight: 700, letterSpacing: 0.5 }}>LISTEN</span>
            </div>
            {/* LIVE — center slot, red circle */}
            <div onClick={triggerLive} style={{ flex: 1, display: "flex", flexDirection: "column", alignItems: "center", gap: 3, cursor: "pointer" }}>
              <div style={{
                width: 44, height: 44, borderRadius: "50%",
                background: "linear-gradient(145deg, #d32f2f, #b71c1c)",
                display: "flex", alignItems: "center", justifyContent: "center",
                boxShadow: "0 2px 8px rgba(211,47,47,0.4)",
              }}>
                <StaticWaveform animating={liveAnimating} />
              </div>
              <span style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 9, fontWeight: 700, letterSpacing: 0.5, color: activeTab === "live" ? "#fff" : "rgba(255,255,255,0.5)" }}>LIVE</span>
            </div>
            {/* WATCH */}
            <div onClick={() => { setActiveTab("watch"); setWatchView("home"); setSelectedSeries(null); setLivePlayerOpen(false); setSettingsOpen(false); }} style={{ flex: 1, display: "flex", flexDirection: "column", alignItems: "center", gap: 4, cursor: "pointer", color: activeTab === "watch" ? "#fff" : "rgba(255,255,255,0.5)" }}>
              <img src="visual_elements/nav_bar_bottom/noun-play-6444203-FFFFFF.png" style={{ width: 24, height: 24, opacity: activeTab === "watch" ? 1 : 0.5 }} />
              <span style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 9, fontWeight: 700, letterSpacing: 0.5 }}>WATCH</span>
            </div>
            {/* PRAY */}
            <div onClick={() => { setActiveTab("pray"); setLivePlayerOpen(false); setSettingsOpen(false); }} style={{ flex: 1, display: "flex", flexDirection: "column", alignItems: "center", gap: 4, cursor: "pointer", color: activeTab === "pray" ? "#fff" : "rgba(255,255,255,0.5)" }}>
              <img src="visual_elements/nav_bar_bottom/noun-pray-1480648-FFFFFF.png" style={{ width: 24, height: 24, opacity: activeTab === "pray" ? 1 : 0.5 }} />
              <span style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 9, fontWeight: 700, letterSpacing: 0.5 }}>PRAY</span>
            </div>
          </div>

          {/* Live Player overlay */}
          {livePlayerOpen && (
            <div style={{ position: "absolute", top: 0, left: 0, right: 0, bottom: 72, zIndex: 100, background: "linear-gradient(180deg, #058340 0%, #112a15 100%)", display: "flex", flexDirection: "column", alignItems: "center" }}>
              {/* Status bar strip — transparent PNG overlaid on gradient */}
              <img src="current_app_state/big_livestream_player_top_strip.PNG" style={{ position: "absolute", top: 0, left: 0, width: "100%", zIndex: 1, pointerEvents: "none" }} />
              {/* Spacer to push content below status bar */}
              <div style={{ height: 44, flexShrink: 0, width: "100%" }} />
              {/* Down chevron — tap to close */}
              <div onClick={() => setLivePlayerOpen(false)} style={{ display: "flex", justifyContent: "center", paddingTop: 10, paddingBottom: 4, cursor: "pointer", width: "100%" }}>
                <svg width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="rgba(255,255,255,0.6)" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round"><polyline points="6 9 12 15 18 9"/></svg>
              </div>
              {/* NOW PLAYING */}
              <div style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 12, fontWeight: 700, letterSpacing: 3, color: "rgba(255,255,255,0.6)", textTransform: "uppercase", marginTop: 6 }}>Now Playing</div>
              {/* Show art */}
              <div style={{ marginTop: 20, flexShrink: 0 }}>
                <img src="rr_shows/morning_air.jpg" style={{ width: 258, height: 258, borderRadius: 14, boxShadow: "0 12px 48px rgba(0,0,0,0.5)", objectFit: "cover", display: "block" }} />
              </div>
              {/* LISTEN LIVE */}
              <div style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 13, fontWeight: 700, letterSpacing: 3, color: "rgba(255,255,255,0.6)", textTransform: "uppercase", marginTop: 28 }}>Listen Live</div>
              {/* Show title */}
              <div style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 24, fontWeight: 700, color: "#fff", marginTop: 8, lineHeight: 1.2, textAlign: "center", padding: "0 32px" }}>Morning Air</div>
              {/* Share icon */}
              <div style={{ marginTop: 16, cursor: "pointer" }}>
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="rgba(255,255,255,0.6)" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"/><polyline points="16 6 12 2 8 6"/><line x1="12" y1="2" x2="12" y2="15"/></svg>
              </div>
              {/* Pause button */}
              <div style={{ marginTop: 28 }}>
                <div style={{ width: 82, height: 82, borderRadius: "50%", background: "#fff", display: "flex", alignItems: "center", justifyContent: "center", boxShadow: "0 6px 24px rgba(0,0,0,0.4)", cursor: "pointer" }}>
                  <svg width="34" height="34" viewBox="0 0 24 24" fill="#1a5c28" stroke="none"><rect x="5" y="3" width="5" height="18" rx="1.5"/><rect x="14" y="3" width="5" height="18" rx="1.5"/></svg>
                </div>
              </div>
            </div>
          )}

        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<AudiobooksApp />);
  </script>
</body>
</html>
